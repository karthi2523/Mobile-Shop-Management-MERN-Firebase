"use strict";(self.webpackChunkmobile_shop_management=self.webpackChunkmobile_shop_management||[]).push([[774],{1774:(e,n,o)=>{o.r(n),o.d(n,{default:()=>N});var s=o(319),t=o(9897),r=o(8047),a=o(2050),c=o(9296),i=o(2424),l=o(5894),d=o(6194),u=o(172),p=o(7354),h=o(8913),x=o(1113),m=o(2203),v=o(7997),b=o(7210),g=o(4524),A=o(7550),f=o(4783),j=o(4234),y=o(5137),w=o(9088),C=o(4841),S=o(1488),k=o(6395),I=o(5940),M=o(2503),D=o(6157);const N=function(){const e=(0,r.Zp)(),[n,o]=(0,t.useState)([]),[N,P]=(0,t.useState)(!0),[T,_]=(0,t.useState)(""),[E,H]=(0,t.useState)(""),[R,U]=(0,t.useState)({}),[W,L]=(0,t.useState)(""),[O,q]=(0,t.useState)(!1),z=async()=>{P(!0);const e=(0,I.rJ)(k.db,"mobileServices");let n=(0,I.P)(e);if(W){const o=new Date(W);o.setHours(0,0,0,0);const s=new Date(o);s.setHours(23,59,59,999),n=(0,I.P)(e,(0,I._M)("timestamp",">=",o),(0,I._M)("timestamp","<=",s))}try{const e=await(0,I.GG)(n),t=[];e.forEach((e=>{const n=e.data();t.push((0,s.A)({id:e.id},n)),U((n=>(0,s.A)((0,s.A)({},n),{},{[e.id]:"Select Status"})))})),o(t)}catch(t){_("Error fetching service details")}P(!1)};(0,t.useEffect)((()=>{z(),(async()=>{const e=(0,M.xI)().currentUser;if(e){const o=(0,I.H9)(k.db,"users",e.uid);try{const e=await(0,I.x7)(o);if(e.exists()){const n=e.data();H(n.username)}else _("User not found")}catch(n){_("Error fetching user details")}}})()}),[W]);const G=e=>{if(!e)return console.log("Service is undefined or null"),"Not Available";const n=(e.passwordType||"").toLowerCase();switch(console.log("Password Type:",n),n){case"pin":return console.log("Pin value:",e.pin),e.pin||"Not Available";case"pattern":return console.log("Pattern value:",e.pattern),e.pattern||"Not Available";case"password":return console.log("Password value:",e.password),e.password||"Not Available";default:return console.log("Unexpected passwordType:",n),"Not Available"}};return(0,D.jsxs)(a.A,{maxWidth:"lg",sx:{backgroundColor:"#f7f7f7",borderRadius:"10px",padding:"20px"},children:[(0,D.jsx)(c.A,{variant:"h4",align:"center",sx:{fontWeight:"bold",color:"#333",mt:4},children:"Serviceman Dashboard"}),(0,D.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:4},children:[(0,D.jsxs)(c.A,{variant:"h6",sx:{fontWeight:"bold",color:"#555"},children:["Welcome, ",N?"Loading...":E]}),(0,D.jsx)(l.A,{color:"primary",onClick:async()=>{const n=(0,M.xI)();try{await(0,M.CI)(n),e("/login")}catch(T){_("Error signing out")}},sx:{color:"#555"},children:(0,D.jsx)(w.A,{})})]}),(0,D.jsx)(i.A,{sx:{mb:4,textAlign:"center"},children:(0,D.jsx)(d.A,{type:"date",label:"Filter by Date",value:W,onChange:e=>L(e.target.value),InputLabelProps:{shrink:!0},sx:{width:"50%",backgroundColor:"#fff",borderRadius:"8px",padding:"10px"}})}),T&&(0,D.jsx)(u.A,{open:!0,autoHideDuration:6e3,onClose:()=>_(""),children:(0,D.jsx)(p.A,{severity:"error",children:T})}),(0,D.jsx)(u.A,{open:O,autoHideDuration:3e3,onClose:()=>q(!1),children:(0,D.jsx)(p.A,{severity:"success",children:"Service updated successfully!"})}),N?(0,D.jsx)(h.A,{sx:{display:"block",mx:"auto",my:4}}):0===n.length?(0,D.jsx)(c.A,{variant:"h6",align:"center",sx:{my:4,color:"#666"},children:"No service requests found."}):(0,D.jsx)(x.Ay,{container:!0,spacing:3,children:n.map((e=>{return(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,D.jsxs)(m.A,{sx:{borderRadius:3,boxShadow:4,transition:"transform 0.2s","&:hover":{transform:"scale(1.05)"},backgroundColor:"#fff"},children:[(0,D.jsxs)(v.A,{children:[(0,D.jsx)(c.A,{variant:"h6",sx:{fontWeight:"bold",color:"#333"},children:e.customerName}),(0,D.jsxs)(c.A,{children:["Mobile: ",e.mobileModel]}),(0,D.jsxs)(c.A,{children:["Service Type: ",e.serviceType]}),(0,D.jsxs)(c.A,{children:["Amount: \u20b9",e.estimatedAmount]}),(0,D.jsxs)(c.A,{children:["Advance: \u20b9",e.advanceAmount]}),(0,D.jsxs)(c.A,{children:["Date: ",(n=e.timestamp,n.toDate().toLocaleDateString())]}),(0,D.jsxs)(c.A,{children:["Notes: ",e.notes||"No notes available"]}),(0,D.jsxs)(c.A,{children:[(0,D.jsx)("strong",{children:"Password Type:"})," ",e.passwordType||"Not Available"]}),(0,D.jsxs)(c.A,{children:[(0,D.jsx)("strong",{children:"Password Value:"})," ",G(e)]})]}),(0,D.jsx)(b.A,{sx:{justifyContent:"center",paddingBottom:"20px"},children:(0,D.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[(0,D.jsxs)(g.A,{fullWidth:!0,sx:{mb:2},children:[(0,D.jsx)(A.A,{children:"Status"}),(0,D.jsx)(f.A,{value:R[e.id]||"Select Status",onChange:n=>{return o=e.id,t=n.target.value,void U((e=>(0,s.A)((0,s.A)({},e),{},{[o]:t})));var o,t},sx:{backgroundColor:"#fafafa",borderRadius:"5px",boxShadow:"none","& .MuiOutlinedInput-notchedOutline":{borderColor:"#ccc"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#3f51b5"}},children:["Select Status","Pending","In Progress","Completed"].map((e=>(0,D.jsx)(j.A,{value:e,children:e},e)))})]}),(0,D.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,D.jsx)(y.A,{variant:"contained",color:"primary",onClick:()=>(async e=>{const n=R[e];if("Select Status"!==n)try{const o=(0,I.H9)(k.db,"mobileServices",e);await(0,I.mZ)(o,{status:n}),q(!0),z()}catch(o){_("Error updating service status")}else _("Please select a valid status.")})(e.id),sx:{padding:"10px 20px",backgroundColor:"#3f51b5","&:hover":{backgroundColor:"#303f9f"}},children:"Update"}),(0,D.jsx)(l.A,{color:"error",onClick:()=>(async e=>{try{const n=(0,I.H9)(k.db,"mobileServices",e);await(0,I.kd)(n),q(!0),z()}catch(n){_("Error deleting service request")}})(e.id),children:(0,D.jsx)(C.A,{})}),(0,D.jsx)(l.A,{color:"success",onClick:()=>(e=>{var n;const o=null===(n=e.customerMobile)||void 0===n?void 0:n.replace(/\D/g,"");if(!o||o.length<10)return void _("Invalid phone number");const s="".concat("+91").concat(o),t=e.serviceId,r=(R[e.id],"Mr Tamizha Mobiles,\n\u0bb5\u0ba3\u0b95\u0bcd\u0b95\u0bae\u0bcd ".concat(e.customerName,",\n\n\n  \u0b89\u0b99\u0bcd\u0b95\u0bb3\u0bcd \u0b9a\u0bc7\u0bb5\u0bc8 \u0b95\u0bcb\u0bb0\u0bbf\u0b95\u0bcd\u0b95\u0bc8\u0baf\u0bbf\u0ba9\u0bcd \u0ba8\u0bbf\u0bb2\u0bc8 \u0b95\u0bc1\u0bb1\u0bbf\u0ba4\u0bcd\u0ba4\u0bc1 \u0ba4\u0bc6\u0bb0\u0bbf\u0bb5\u0bbf\u0b95\u0bcd\u0b95 \u0bb5\u0bbf\u0bb0\u0bc1\u0bae\u0bcd\u0baa\u0bc1\u0b95\u0bbf\u0bb1\u0bc7\u0ba9\u0bcd. \n\n  \u0b9a\u0bc7\u0bb5\u0bc8 \u0bb5\u0b95\u0bc8: ").concat(e.serviceType," \n\n  \u0b9a\u0bc7\u0bb5\u0bc8 \u0b90\u0b9f\u0bbf: ").concat(t," \n\n\n  \u0b9a\u0bc7\u0bb5\u0bc8\u0baf\u0bbf\u0ba9\u0bcd \u0ba8\u0bbf\u0bb2\u0bc8\u0baf\u0bc8 \u0baa\u0bb0\u0bbf\u0b9a\u0bcb\u0ba4\u0bbf\u0b95\u0bcd\u0b95 \u0b87\u0b99\u0bcd\u0b95\u0bc1 \u0b95\u0bbf\u0bb3\u0bbf\u0b95\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb5\u0bc1\u0bae\u0bcd: https://mobile-shop-management-c72c6.web.app/check-service-status?serviceId=").concat(t,"\n\n\n  \u0ba8\u0ba9\u0bcd\u0bb1\u0bbf!")),a=encodeURIComponent(r),c="https://wa.me/".concat(s,"?text=").concat(a);window.open(c,"_blank")})(e),children:(0,D.jsx)(S.A,{})})]}),(0,D.jsxs)(i.A,{sx:{display:"flex",gap:1,marginTop:"10px"},children:[(0,D.jsx)(y.A,{variant:"outlined",color:"secondary",onClick:()=>(e=>{var n;const o=null===(n=e.customerMobile)||void 0===n?void 0:n.replace(/\D/g,"");o&&o.length>=10?window.open("tel:+91".concat(o)):_("Invalid phone number for call.")})(e),sx:{padding:"10px 20px",color:"#4caf50",borderColor:"#4caf50","&:hover":{borderColor:"#388e3c",color:"#388e3c"}},children:"Call"}),(0,D.jsx)(y.A,{variant:"outlined",color:"primary",onClick:()=>(e=>{var n;const o=null===(n=e.customerMobile)||void 0===n?void 0:n.replace(/\D/g,"");if(o&&o.length>=10){const n="Mr Tamizha Mobiles,\n\u0bb5\u0ba3\u0b95\u0bcd\u0b95\u0bae\u0bcd ".concat(e.customerName,",\n\n\n      \u0b89\u0b99\u0bcd\u0b95\u0bb3\u0bcd \u0b9a\u0bc7\u0bb5\u0bc8 \u0b95\u0bcb\u0bb0\u0bbf\u0b95\u0bcd\u0b95\u0bc8\u0baf\u0bbf\u0ba9\u0bcd \u0ba8\u0bbf\u0bb2\u0bc8 \u0b95\u0bc1\u0bb1\u0bbf\u0ba4\u0bcd\u0ba4\u0bc1 \u0ba4\u0bc6\u0bb0\u0bbf\u0bb5\u0bbf\u0b95\u0bcd\u0b95 \u0bb5\u0bbf\u0bb0\u0bc1\u0bae\u0bcd\u0baa\u0bc1\u0b95\u0bbf\u0bb1\u0bc7\u0ba9\u0bcd. \n\n      \u0b9a\u0bc7\u0bb5\u0bc8 \u0bb5\u0b95\u0bc8: ").concat(e.serviceType," \n\n      \u0b9a\u0bc7\u0bb5\u0bc8 \u0b90\u0b9f\u0bbf: ").concat(e.serviceId," \n\n\n      \u0b9a\u0bc7\u0bb5\u0bc8\u0baf\u0bbf\u0ba9\u0bcd \u0ba8\u0bbf\u0bb2\u0bc8\u0baf\u0bc8 \u0baa\u0bb0\u0bbf\u0b9a\u0bcb\u0ba4\u0bbf\u0b95\u0bcd\u0b95 \u0b87\u0b99\u0bcd\u0b95\u0bc1 \u0b95\u0bbf\u0bb3\u0bbf\u0b95\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0baf\u0bb5\u0bc1\u0bae\u0bcd: https://mobile-shop-management-c72c6.web.app/check-service-status?serviceId=").concat(e.serviceId,"\n\n\n      \u0ba8\u0ba9\u0bcd\u0bb1\u0bbf!"),s=encodeURIComponent(n),t="sms:+91".concat(o,"?body=").concat(s);window.open(t,"_blank")}else _("Invalid phone number for SMS.")})(e),sx:{padding:"10px 20px",color:"#2196f3",borderColor:"#2196f3","&:hover":{borderColor:"#1976d2",color:"#1976d2"}},children:"SMS"})]})]})})]})},e.id);var n}))})]})}}}]);
//# sourceMappingURL=774.c8064914.chunk.js.map